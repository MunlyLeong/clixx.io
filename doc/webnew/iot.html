<html>
      <head>

      <title>Clixx.IO :: IoT Framework</title>

      <meta name="viewport" content="width=800">
      <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.css">
      <link rel="stylesheet" href="working.css">
      <link rel="stylesheet" href="font_awesome.css">
      <link rel="stylesheet" href="themes/clixxio.cs">
      <link href="pygments.css" rel="stylesheet">
      <link href="http://clixx.io/assets/img/favicon.ico" rel="shortcut icon"><link href="rss.xml" type="application/rss+xml" rel="alternate" title="The Garage Lab (RSS 2.0)"><meta content="-hwGgpHftBBc6_gN-SP2pH4krm_dQ4E2Q1bFWGbjIIA" name="google-site-verification">

      <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
      <script src="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js"></script>

      </head>

      <body>

      <div data-role="page">
      
           <!-- the slide-away navigation panel -->
           <div data-role="panel" id="nav_panel">
                <h3>Discover clixx.io</h3>
                  <a data-role="button" href="about.html">About</a>
                  <a data-role="button" href="projects.html">Projects</a>
           <!-- 
                  <a data-role="button">Learning</a>
           -->
                <h3>Software</h3>
                  <a data-role="button" href="iot.html">IoT Framework</a>
           <!-- 
                  <a data-role="button" href="http://clixx.io/documents/about.html">Downloads</a>
                <h3>Community</h3>
           -->
                <h3>Hardware</h3>
                  <a data-role="button" href="processors.html">Processors</a>
                  <a data-role="button" href="docks.html">Docks</a>
                  <a data-role="button" href="tabs.html">Interface Boards</a>
           <!-- 
                  <a data-role="button" >Processors</a>
           -->
                <h3>Buy</h3>
                  <a data-role="button" href="http://clixx.io/documents/contact.html">Shop</a>
                <h3>Support</h3>
                <a data-role="button" href="contact.html">Contact</a>
           </div><!-- /panel -->

           <div data-role="header">
                <div class="tgl-header">
                     <div class="header-inner" style="height:120px;">
                          <a data-role="button" data-mini="true" data-icon="grid" data-theme="b" data-iconpos="notext" href="#nav_panel"></a>
                     </div>
                </div>
           </div><!-- /header -->


           <div data-role="content" style="text-align:Left">

<div role="main" class="ui-content jqm-content">

		<h1>IoT Framework</h1>

		<p>To build IoT systems quickly and efficiently, you need a good software framework. clixx.io offers a modern
		   Event-Based framework for C++ development.</p>

<p>The clixx.io EventFramework is a streamlined EventFramework designed
to give C++ compatability over a wide variety of processors. At the
moment to demonstrate the concept we have Linux and the Attiny85. In 
the future, we'd like to do more processors.</p>

<h3>Designed to Support MQTT</h3>
<p>In the IoT world, MQTT is a clear favourite because it's easy and fast to get
up and running and supports many acknowledged security fundimentals. Clixx.io is
specifically designed to incorporate excellent support for MQTT. For more
information, click <a href="mqtt_intro.html">MQTT Introduction</a> and <a href="mqtt_cli.html">MQTT CLI</a></p>
<p>We even provide a power <a href="mqtt_router.html">MQTT Router </a>to make it easy to bridge devices like
the Arduino to the Internet extremely easily.</p>
<h3>Our Event-Framework</h3>
<p>In the embedded world, Arduino is the clear favourite. But it's closely
tied down to the Arduino hardware. This framework provides a way to get
more programming features and not be locked down to a particular brand
of hardware.</p>

<p>Wiring/Arduino gives just one grouping construct - loop() which is
great. This framework extends that and gives more:</p>

<li><b>loop()</b> repeating loop</li>
<li><b>pinchange()</b> 	- hardware Pin change interrupts</li>
<li><b>timer()</b>- Timer based callbacks</li>
<li><b>iotmessage()</b>	- IoT messages</li>
<li><b>serial()</b>	- Data from serial ports</li>
	
<h3>The easy coding style of the clixx.io Event-Framework</h3>

<p>The clixx.io Eventframework is based on having an 'Application'
class which then passes program execution to event-handlers when
particular hardware or software events occur).</p>

	<pre><code>
	/* Simple Application
	 * 
	 *  A trivial simple example of an clixx.io Application.
	 * 
	*/
	#include &ltstdio.h&gt;
	#include "clixxIO.hpp"

	class App : public clixxIOApp{

		int loop(){
			// loop handler - This runs repeatedly
			if (getTemperature() > 24)
				aircon.On();
			else
				aircon.Off();
			delay(1000);
		};
		
		int setup(){
			// Setup - register the loop event for continuously running. 
			printf("Program is running");
			
			aircon = clixxIO_Motor('motor1');
			addLoopEvent(&amploop());
		};
		
	};

	// -- Main program Section. Simply setup an App class and let it run
	int main(){
	  App m;
	  return m.run();
	} 
	#include "app-callbacks.cpp"	// 
	</code></pre>

<h3>Setup - setup()</h3>

<p>The setup() function is executed once at start of the program and
is normally used to initialise devices.</p>

	<pre><code>
	void setup(){
		// setup - create a timer callback every 2 seconds
		addTimerEvent(2, (void (*)()) &App::timerevent);

        // Setup all of the devices that are needed by the application		
		lcd = clixxIO_i2cCharlcd();
		button1 = clixxIO_Button('button1');
		button2 = clixxIO_Button('button2');
		motor1  = clixxIO_Motor('motor1');
		 
	};
	</code></pre>

<h3>Loop - loop()</h3>

<p>The loop() function is an optional method that can be repeatedly
run. It's not necessary to have a program loop() if the program
is running on other events, such as interrupts or serial-data
for example.</p>

	<pre><code>
    int loop(){
        // loop - this runs repeatedly
        if (getTemperature() &gt 24)
			setAirconditioning(On);
		else
			setAirconditioning(Off);
		delay(1000);
    };
    
	void setup(){
        addLoopEvent((void (*)()) &AmpApp::loop);
    };
	</code></pre>

<h3>Timers - ontimer()</h3>

<p>The vast majority of embedded applications all need timers for some
purpose. Traditionally it's been left to the engineer to interface
to the hardware/operating-system to determine a base for the timing
system of the application. Not only does that require some effort,
it has led to a huge amount of program incompatability as programs
are coded to use the timing hardware of a particular platform rather
than get on with the job of actually doing the timing functions.</p>

<p>The following example shows the same functionality of the above
example only here the checking is done by timer callbacks which
are non-blocking rather than using a blocking delay() call in
the previous example:</p>

	<pre><code>
    void ontimer(){
        // timerevent - this is run every second
		if (getTemperature() > 24)
			aircon.On();
		else
			aircon.Off();
    };
	void setup(){
		// setup - create a timer to check the temperature every 2 seconds
		addTimerEvent(1, (void (*)()) &AmpApp::ontimer);
	};
	</code></pre>


<h3>Hardware Interrupts - onpinchange()</h3>

<p>From the dawn of programming computers, there haven't been that many nice ways
to handle pin change interrupts from an application. </p>

<p>Handling pin change interrupts is now moved into the main application object
and is available as part of the core application code rather than moved (usually) a
long way away from the main() function where most of the application logic is
expected to be.</p>

<p>With this structure, handling interrupts becomes part of the main application
functionality.</p>

	<pre><code>
	int setup(){
		// Setup - create a timer that displays data every second
		//         as well as a pin change interrupt handler
		addTimerEvent(1, (void (*)()) &AmpApp::timerevent);
		addPinChangeEvent(GPIO_PIN16, RISING, (void (*)()) &AmpApp::onpinchange());
	};
	
	int timerevent(){
		// timerevent - fired every second to display the value
		int v = counter; counter = 0;
		if (v == 0)
			printf('.')
		else
			printf("rps = %d\n", v);
	};
	
	void onpinchange(){
		/* Interrupt service routine
		Handles a hardware interrupt of some sort
		*/
		++counter;
	}
	</code></pre>

<h3>Serial Port Data - onserial()</h3>

<p>One of the very first things that computers ever did was send data over
serial ports. Unfortunately, until the Wiring language, there's never been
that many consistent interfaces for handling serial data streams.</p>

<p>In the EventFramework, serial data can be received and passed to the
application either in blocks or lines with a callback able to be setup
when the data is available.</p>

	<pre><code>
	int setup(){
		// Setup - create an event that prints out serial data from a port
		//         as well as a pin change interrupt handler
		addSerialDataEvent(GPIO_PIN1, 9600, (void (*)()) &AmpApp::onserial());
	};
   
	int onserial(const char* buffer, const int bufflen){
		//* SerialData - Print out the data received on the port
		printf(buffer)

	}
	</code></pre>

	</div><!-- /content -->

           </div><!-- /content -->

           <div data-role="footer">
                <div class="footer">

                             <a style="float: left; margin-right: 2px" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US" rel="license">
                             <img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" alt="Creative Commons License" style="border-width:0"></a>
                             <a href="rss.xml" class="footer-feed"><i class="icon-rss"></i> RSS</a>

                             <div class="footer-copyright">
                                  All original content copyright (c) 2013 David Lyon &lt;<a href="mailto:info@clixx.io">info@clixx.io</a>&gt;<br>
                                  This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US" rel="license">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
                             </div>
                </div>
           </div><!-- /footer -->
      </div><!-- /page -->

      <script src="http://clixx.io/assets/js/garagelab.js"></script>

      <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'clixxio'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
            }());
      </script>

      </body>
</html>
